# 1. Generación de SSH key
### Generamos una clave Ed25519 (Segura y rápida)
```bash
ssh-keygen -t ed25519 -C "tu_correo@ejemplo.com" -f ~/.ssh/tu_clave
```
(Es recomendable colocar una passphrase como contraseña segura).

Esto creará dos archivos para tu clave una publica y otra privada en la carpeta ~/.ssh

# 2. Configuración manual de agente SSH (Opcional - Aprendizaje)
### Iniciamos el agente SSH
```bash
eval "$(ssh-agent -s)"
```
### Buscamos nuestra clave
```bash
cd ~/.ssh
```
```bash
ls -a
```
Verás tu clave privada y la clave publica (.pub)
### Agregamos nuestra clave privada SSH al agente
```bash
ssh-add ~/.ssh/tu_clave
```
### Verificamos que fue añadida
```bash
ssh-add -l
```

# 3. Automatizar el agente SSH
### Configuración Básica
#### Crear el archivo "config" en la ruta ~/.ssh:
```bash
nano ~/.ssh/config
```
#### Escribir el siguiente contenido:
```bash
Host *
    AddKeysToAgent yes
    IdentityFile ~/.ssh/tu_clave
    IdentitiesOnly yes
```
### Iniciar el agente automáticamente
#### Abrimos el archivo de inicio (Bash, Zsh, etc...):
##### .bashrc:
```bash
nano ~/.bashrc
```
##### .zshrc:
```bash
nano ~/.zshrc
```
#### Escribimos esta linea al final del archivo:
```bash
if [ -z "$SSH_AUTH_SOCK" ] || [ ! -S "$SSH_AUTH_SOCK" ]; then
    eval "$(ssh-agent -s)" >/dev/null
fi
```
Este comando inicia el ssh-agent solo si no existe o el socket no es válido.
> Nota: este método funciona por sesión de usuario.
> Al cerrar sesión o reiniciar el sistema, el agente se reinicia.

# 4. Conexión con Github
### Agregamos la clave a Github
#### Copiamos el contenido de la clave publica:
```bash
cat ~/.ssh/tu_clave.pub
```
### Agregamos en Github
1. Ve a: https://github.com/settings/keys
2. Haz clic en New SSH key
3. En Title: ponle un nombre (por ejemplo “Mi PC principal”)
4. En Key: pega el contenido copiado.
5. Guarda con Add SSH key.
### Probamos la conexión
```bash
ssh -T git@github.com
```
#### Si todo está correcto, te responderá:
```text
Hi TuUsuario! You’ve successfully authenticated…
```

# 5. Configurar Git para usar SSH
### Crear o vincular un repositorio local
#### Si no tienes un repositorio aún:
```bash
git init
```
#### Si ya tienes uno existente:
```bash
git clone git@github.com:usuario/repositorio.git
```
### Verificar si el repositorio tiene un remoto vinculado
```bash
git remote -v
```
- Si aparece una URL HTTPS, debes cambiarla a SSH
- Si no hay nada, significa que no existe un remoto aún
### Agregar o corregir el remoto para usar SSH
#### Si no hay remoto configurado:
```bash
git remote add origin git@github.com:usuario/repositorio.git
```
#### Si la URL remota es HTTPS y debe cambiarse a SSH:
```bash
git remote set-url origin git@github.com:usuario/repositorio.git
```
### Verificamos el resultado
```bash
git remote -v
```
#### Debe mostrar:
```text
origin  git@github.com:usuario/repositorio.git (fetch)
origin  git@github.com:usuario/repositorio.git (push)
```

# 6. Uso de múltiples claves SSH (Opcional - Avanzado)
> Al usar múltiples claves SSH:
> - Elimina o comenta cualquier `IdentityFile` definido en `Host *`
> - Cada identidad debe definirse únicamente por `Host`
### Generamos claves separadas
#### Personal:
```bash
ssh-keygen -t ed25519 -C "personal@correo.com" -f ~/.ssh/tu_clave_personal
```
#### Trabajo:
```bash
ssh-keygen -t ed25519 -C "trabajo@empresa.com" -f ~/.ssh/tu_clave_trabajo
```
### Configurar el archivo SSH para manejar múltiples identidades
#### Crear el archivo config en la ruta ~/.ssh:
```bash
nano ~/.ssh/config
```
#### Escribir el siguiente contenido:
```bash
# GitHub personal
Host github-personal
    HostName github.com
    User git
    IdentityFile ~/.ssh/tu_clave_personal
    AddKeysToAgent yes
    IdentitiesOnly yes

# GitHub trabajo
Host github-trabajo
    HostName github.com
    User git
    IdentityFile ~/.ssh/tu_clave_trabajo
    AddKeysToAgent yes
    IdentitiesOnly yes
```
### Usar los hosts personalizados en cada repositorio
#### Para repositorio de la cuenta personal:
```bash
git remote set-url origin git@github.com-personal:usuario/repositorio.git
```
#### Para repositorios de la cuenta de trabajo:
```bash
git remote set-url origin git@github.com-trabajo:empresa/proyecto.git
```

# 7. Línea de prueba extra para debugging (opcional)
Si necesitas diagnosticar problemas con la conexión SSH, puedes usar el siguiente comando para obtener más información sobre lo que está sucediendo.
#### Comando para debugging:
```bash
ssh -vT git@github.com
```
Este comando agrega una salida detallada sobre el proceso de autenticación, desde la selección de la clave hasta la autenticación completa.
#### Qué esperar en la salida:
- Primera parte: SSH te mostrará qué claves está probando.
- Segunda parte: Te indicará si la clave fue aceptada o si hubo algún error.
##### Ejemplo de salida:
```text
OpenSSH_8.1p1 Debian-1, OpenSSL 1.1.1d  10 Sep 2019
debug1: Reading configuration data /home/usuario/.ssh/config
debug1: /home/usuario/.ssh/config line 1: Applying options for *
debug1: Connecting to github.com [140.82.112.4] port 22.
debug1: Connection established.
debug1: identity file /home/usuario/.ssh/tu_clave type -1
debug1: identity file /home/usuario/.ssh/tu_clave-cert type -1
debug1: Offering public key: /home/usuario/.ssh/tu_clave RSA SHA256:XXXXXXXXXX
debug1: Authentication succeeded (publickey).
Authenticated to github.com ([140.82.112.4]:22).
```
### Análisis:
- Si la autenticación es exitosa, verás algo como: 
```text
Authentication succeeded (publickey).
```
- Si algo sale mal, puedes ver qué clave falló o si la clave no fue aceptada.
